!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("MiniValine",[],t):"object"==typeof exports?exports.MiniValine=t():e.MiniValine=t()}(window,(function(){return function(e){function t(t){for(var n,i,o=t[0],a=t[1],c=0,u=[];c<o.length;c++)i=o[c],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(l&&l(t);u.length;)u.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=o);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.src=function(e){return i.p+"MiniValine."+({1:"body-DesertsP",2:"body-xCss",3:"lib",4:"math",5:"md",6:"md-style",7:"style-DesertsP",8:"style-xCss",9:"vendors~lib",10:"vendors~md",11:"vendors~xss",12:"xss"}[e]||e)+".min.js"}(e);var l=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",l.name="ChunkLoadError",l.type=i,l.request=o,n[1](l)}r[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://cdn.jsdelivr.net/npm/minivaline@2.0.1/dist/",i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpMiniValine=window.webpackJsonpMiniValine||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=a;return i(i.s=8)}([function(e,t,n){"use strict";var r={on:function(e,t,n,i){for(var o=0,a=(e=e.split(" ")).length;o<a;o++)r.off(e[o],t,n,i),t.addEventListener?t.addEventListener(e[o],n,i||!1):t.attachEvent?t.attachEvent("on".concat(e[o]),n):t["on".concat(e[o])]=n},off:function(e,t,n,r){for(var i=0,o=(e=e.split(" ")).length;i<o;i++)t.removeEventListener?t.removeEventListener(e,n,r||!1):t.detachEvent?t.detachEvent("on".concat(e),n):t["on".concat(e)]=null}};e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION="2.0.1",t.GBUrl="https://gravatar.loli.net/avatar/",t.ip="https://api.ip.sb/jsonip?callback=getIP",t.EUrl=["https://cdn.jsdelivr.net/npm/alus@latest"],t.pf="https://cdn.polyfill.io/v3/polyfill.min.js?features=es6",t.i18nUrl="https://cdn.jsdelivr.net/gh/MiniValine/minivaline-i18n@latest/",t.DEHash="9e63c80900d106cbbec5a9f4ea433a3e",t.MaxNL=6,t.PS=6,t.C={ip:"",comment:"",rid:"",at:"",nick:"",mail:"",link:"",ua:navigator.userAgent,url:location.pathname,pin:0}},function(e,t,n){"use strict";e.exports=function(e,t){Promise.all([n.e(11),n.e(12)]).then(n.t.bind(null,50,7)).then((function(n){var r=n.XSS;e.TEXT=r(e.TEXT),t(e)}))}},function(e,t,n){"use strict";var r=function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.push(("v="+Math.random()).replace(".","")),t.join("&")};e.exports=function(e){(e=e||{}).type=(e.type||"GET").toUpperCase(),e.dataType=e.dataType||"json";var t=r(e.data);if(window.XMLHttpRequest)var n=new XMLHttpRequest;else n=new ActiveXObject("Microsoft.XMLHTTP");n.onreadystatechange=function(){if(4===n.readyState){var t=n.status;200<=t&&t<300?e.success&&e.success(n.responseText,n.responseXML):e.fail&&e.fail(t)}},"GET"==e.type?(n.open("GET",e.url+"?"+t,!0),n.send(null)):"POST"==e.type&&(n.open("POST",e.url,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(t))}},function(e,t,n){"use strict";e.exports=function(e,t){if(document.selection)e.focus(),document.selection.createRange().text=t,e.focus();else if(e.selectionStart||"0"==e.selectionStart){var n=e.selectionStart,r=e.selectionEnd,i=e.scrollTop;e.value=e.value.substring(0,n)+t+e.value.substring(r,e.value.length),e.focus(),e.selectionStart=n+t.length,e.selectionEnd=n+t.length,e.scrollTop=i}else e.focus(),e.value+=t}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e){var t=localStorage&&localStorage.getItem("MiniValineCache");if(t){t=JSON.parse(t);for(var n=["nick","link","mail"],i=0;i<n.length;i++){var o=n[i];e.el.querySelector(".v".concat(o)).value=t[o],e.C[o]=t[o]}""!==t.mail&&"DesertsP"===e.mode&&e.el.querySelector(".visitor_avatar").setAttribute("data-src","".concat(r.GBUrl+md5(t.mail.toLowerCase().trim()),"?size=80&d=https%3a%2f%2fgravatar.loli.net%2favatar%2f9e63c80900d106cbbec5a9f4ea433a3e.jpg%3fsize%3d80"))}}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(37));e.exports=function(e,t,n){var i=e.C.comment.match(/!\(:(.*?\.\w+):\)/g);if(i)for(var o=0;o<i.length;o++){var a=i[o].match(/!\(:(.*?\.\w+):\)/)[1],c=e.emoticon[a],l=new RegExp("!\\(:"+a.replace(/\./,"\\.")+":\\)","g");e.C.comment=e.C.comment.replace(l,'<img src="'.concat(c,'" alt="').concat(a,'" class="vemoticon-img">'))}t.TEXT=e.C.comment,(0,r.default)(e,t,n)}},function(e,t,n){"use strict";e.exports=function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.getElementsByTagName("head")[0].appendChild(t)}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(9)),i=n(1),o=function(e){return console.log("%c MiniValine %c v"+i.VERSION+" ","color: white; background: #0078E7; padding:5px 0;","padding:4px;border:1px solid #0078E7;"),new r.default(e)};e.exports=o,e.exports.default=o},function(e,t,n){"use strict";var r=o(n(10)),i=o(n(16));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){var t=this;t.config=e,i.default.Config(t),i.default.initStyle(t),i.default.ActivateCode(t),i.default.script(t),i.default.i18n(t),i.default.smile(t),i.default.initLibs(t)};a.prototype.initCheck=function(){var e=this,t=setInterval((function(){void 0!==e.i18n&&(clearInterval(t),"DesertsP"===e.mode?n.e(1).then(n.t.bind(null,44,7)).then((function(t){var n=t.getEle;e.ele=n(e),e.initBody()})):"xCss"===e.mode&&n.e(2).then(n.t.bind(null,45,7)).then((function(t){var n=t.getEle;e.ele=n(e),e.initBody()})))}),5)},a.prototype.initBody=function(){var e=this;try{r.default.el(e),r.default.loading(e),e.nodata.show(),r.default.smiles(e),i.default.setAV(e)}catch(e){return void console.log(e)}e.loading.hide(e.parentCount),i.default.alert(e),e.loading.show(),i.default.initCount(e),e.bind()},a.prototype.bind=function(){var e=this;i.default.inputs(e),i.default.previewEvt(e),i.default.smileEvt(e),"DesertsP"===e.mode&&i.default.startEvt(e),i.default.getCache(e),i.default.resetForm(e),i.default.uploadImage(e),i.default.cancelReply(e),i.default.smileBtnEvt(e),i.default.previewBtnEvt(e),i.default.atEvt(e),i.default.submitBtnEvt(e),i.default.insertComment(e,r.default),i.default.parentQuery(e),i.default.nestQuery(e)},e.exports=a},function(e,t,n){"use strict";var r=c(n(11)),i=c(n(13)),o=c(n(14)),a=c(n(15));function c(e){return e&&e.__esModule?e:{default:e}}e.exports={vcard:r.default,loading:i.default,smiles:o.default,el:a.default}},function(e,t,n){"use strict";var r=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(n(12)),o=function(e){var t=e.get("emailHash"),n="".concat(r.GBUrl+t,"?size=80&d=https%3a%2f%2fgravatar.loli.net%2favatar%2f9e63c80900d106cbbec5a9f4ea433a3e.jpg%3fsize%3d80");if(0<=e.get("mail").indexOf("@qq.com")){var i=e.get("mail").replace(/@.*/,"");null!==i.match(/^\d+$/g)&&(n="https://q1.qlogo.cn/g?b=qq&nk="+i+"&s=100")}return n};e.exports=function(e,t){var n=t.get("emailHash"),r=o(t);return'<div class="vcomment-body"><div class="vhead" >'+'<img class="vavatar lazyload" data-src="'.concat(r,'"/>')+"<a rid='".concat(t.id,"' at='@").concat(t.get("nick"),'\' class="vat" id="at-').concat(t.id,'">').concat(e.i18n.reply,"</a>")+'<div class="vmeta-info">'.concat(t.get("link")?'<a class="vname" href="'.concat(t.get("link"),'" target="_blank" rel="nofollow" > ').concat(t.get("nick"),"</a>"):'<span class="vname">'.concat(t.get("nick"),"</span>")).concat(n===e.adminEmailMd5.toLowerCase().trim()?'<span class="spacer">Â·</span><span class="vtime"><svg xmlns:xlink="http://www.w3.org/1999/xlink" p-id="1615" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024" style="height: .8em;width: .8em;fill: #777;" class="icon" t="1559101574545"><defs><style type="text/css"></style></defs><path d="M582.044306 993.554603l17.113098-99.494753-72.233191-70.442285c-25.072678-24.27672-34.027206-57.109988-24.07773-87.555383 9.949475-30.445394 36.41508-51.538282 70.840264-56.51302l87.356393-12.735328c-3.780801-2.586864-7.163622-5.173727-10.347454-7.95958-10.944423-9.551496-18.705014-19.699961-23.480762-30.047415s-7.561601-21.092888-8.15857-31.440342c-0.596969-10.546444 0-20.893898 1.989895-31.042363 1.392927-8.15857 3.581811-15.123202 6.168675-20.893898 2.586864-5.770696 5.969685-10.546444 10.148465-14.725223 4.17878-3.97979 8.755538-7.95958 14.327244-11.541391 5.571706-3.780801 11.143412-8.15857 17.312087-13.730276 5.372717-4.775748 10.148465-11.342402 14.725223-19.898951 4.17878-8.357559 8.15857-17.113098 11.541391-25.868636 3.382822-9.949475 6.566654-20.694909 9.153517-31.440342 6.765643-1.989895 13.133307-5.571706 19.301982-11.143412 5.372717-4.775748 10.148465-11.342402 14.725223-19.898951 4.17878-8.556549 7.561601-19.699961 9.551496-34.027206 1.392927-10.944423 1.193937-19.898951-0.397979-27.460552-1.591916-7.561601-3.97979-13.531286-6.566654-18.307035-2.586864-5.571706-6.367664-9.750486-11.143412-12.337349 0.596969-27.062573-0.994948-54.324135-5.173727-81.386708-3.183832-23.082783-9.153517-47.558492-17.710066-73.626117s-21.291877-49.946366-38.205985-71.636222c-7.561601-9.551496-17.312087-18.904003-29.649436-28.05752-11.93937-9.153517-26.067625-17.312087-41.588807-24.873688-15.720171-7.561601-32.43529-13.531286-50.344345-18.307035s-37.012048-7.163622-56.51302-7.163622c-15.720171 0-31.838321 1.591916-48.35445 4.17878-16.715119 2.984843-33.032258 7.561601-49.349398 14.327244-16.31714 6.765643-32.43529 16.11815-48.35445 28.05752s-30.246405 27.062573-43.180723 45.369607c-13.531286 19.500972-23.878741 41.588807-31.042363 66.064516-7.163622 24.475709-12.13836 47.558492-14.725223 69.248348-3.581811 25.868636-4.775748 51.737272-4.17878 77.406918-5.571706 6.964633-9.750486 13.929265-12.337349 21.490867-2.785853 6.765643-4.576759 14.725223-5.571706 23.878741-1.193937 9.153517 0 19.699961 3.382822 31.042363 3.581811 11.541391 7.561601 20.29693 12.337349 26.465604 4.775748 6.168675 9.153517 10.944423 13.332297 14.327244 4.775748 3.581811 9.551496 5.770696 14.327244 7.163622 3.382822 10.745433 6.765643 21.291877 10.148465 31.440342 3.382822 8.755538 6.964633 17.312087 11.143412 25.868636 4.17878 8.556549 8.755538 15.123202 14.327244 19.898951 11.740381 9.551496 21.888846 18.705014 31.042363 27.460552 9.153517 8.755538 14.327244 21.291877 15.720171 37.609017 0.596969 10.347454 0.994948 19.898951 0.994948 28.654489 0 8.954528-1.591916 17.312087-4.576759 25.470657-2.984843 8.15857-8.556549 16.31714-16.31714 24.475709-7.760591 8.15857-18.705014 16.715119-33.032258 25.470657-17.511077 11.541391-38.006996 20.29693-61.487757 26.465604-23.480762 6.168675-125.761368 41.389817-147.849203 48.951419-21.888846 7.362612-41.190828 17.511077-57.507967 30.445394-16.11815 12.735328-26.266615 31.838321-30.445394 56.910999C2.387875 881.52351 0.994949 888.488143 4.57676 916.346674c3.581811 27.659541 9.153517 44.17567 16.715119 49.747377 6.168675 4.576759 23.679751 10.148465 52.931209 16.715119 29.251457 6.566654 213.11776 41.190828 426.633501 41.190828 27.858531 0 54.722114-0.596969 80.59075-1.790906C580.253401 1012.856585 580.45239 1003.305088 582.044306 993.554603z" p-id="1616"></path><path d="M1004.300038 748.399532l-106.459386-15.521182c-16.31714-2.387874-35.619122-16.31714-42.981733-31.241353l-47.558492-96.509911c-3.581811-7.362612-8.556549-11.143412-13.332297-11.143412-4.775748 0-9.551496 3.780801-13.332297 11.143412l-47.558492 96.509911c-7.362612 14.725223-26.664594 28.853478-42.981733 31.241353l-106.459386 15.521182c-16.31714 2.387874-20.09794 13.730276-8.15857 25.271667l77.008939 75.019044c11.740381 11.541391 19.102993 34.226195 16.31714 50.543335l-18.108045 106.061407c-1.989895 11.740381 2.586864 18.705014 10.745433 18.705014 3.183832 0 6.765643-0.994948 10.745433-3.183832l95.116984-50.145356c7.362612-3.780801 16.914108-5.770696 26.465604-5.770696 9.551496 0 19.301982 1.989895 26.465604 5.770696l95.116984 50.145356c3.97979 2.188885 7.760591 3.183832 10.745433 3.183832 8.15857 0 12.735328-6.964633 10.745433-18.705014l-18.108045-106.061407c-2.785853-16.31714 4.576759-39.001943 16.31714-50.543335l77.008939-75.019044C1024.198988 762.129808 1020.617177 750.787406 1004.300038 748.399532z" p-id="1617"></path></svg></span><span class="spacer">Â·</span>':'<span class="spacer">Â·</span>')+'<span class="vtime">'.concat((0,i.default)(t.get("createdAt"),e.i18n),"</span>")+"</div></div>"+'<section class="text-wrapper"  id="comment-'.concat(t.id,'">')+'<div class="vcomment">'.concat(t.get("comment"),"</div>")+'</section></div><div class="vcomment-children"><div class="vshow-children-wrapper" style="display: none"></div>'+'<ul class="vlist" id="children-list-'.concat(t.id,'"></ul>')+"</div>"}},function(e,t,n){"use strict";var r=function(e){var t=i(e.getDate(),2),n=i(e.getMonth()+1,2),r=i(e.getFullYear(),2);return"".concat(r,"-").concat(n,"-").concat(t)},i=function(e,t){for(var n=e.toString();n.length<t;)n="0".concat(n);return n};e.exports=function(e,t){try{var n=e.getTime(),i=(new Date).getTime()-n,o=Math.floor(i/864e5);if(0!==o)return o<0?t.now:o<365?"".concat(o," ").concat(t.days):r(e);var a=i%864e5,c=Math.floor(a/36e5);if(0!==c)return"".concat(c," ").concat(t.hours);var l=a%36e5,u=Math.floor(l/6e4);if(0!==u)return"".concat(u," ").concat(t.minutes);var s=l%6e4,d=Math.round(s/1e3);return 0===d?t.now:"".concat(d," ").concat(t.seconds)}catch(e){console.log(e)}}},function(e,t,n){"use strict";e.exports=function(e){var t=e.el.querySelector(".vempty");e.nodata={show:function(n){t.innerHTML=n||e.i18n.noCommentYet,t.setAttribute("style","display:block;")},hide:function(){t.setAttribute("style","display:none;")}};var n='<div class="spinner"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div><div class="r5"></div></div>',r=e.el.querySelector(".vloading");r.innerHTML=n,e.loading={show:function(){r.setAttribute("style","display:block;"),e.nodata.hide()},hide:function(t){r.setAttribute("style","display:none;"),0===t&&e.nodata.show()}};var i=e.el.querySelector(".vsubmitting");i.innerHTML=n,e.submitting={show:function(){i.setAttribute("style","display:block;")},hide:function(){i.setAttribute("style","display:none;"),e.nodata.hide()}}}},function(e,t,n){"use strict";e.exports=function(e){var t=setInterval((function(){if(void 0!==e.emoticonList){clearInterval(t);var n=e.el.querySelector(".vsmile-icons"),r=e.emoticonList||[];for(var i in r)if(r.hasOwnProperty(i)){var o=document.createElement("img");o.setAttribute("data-src","".concat(r[i])),o.setAttribute("class","lazyload"),n.appendChild(o)}}}),10)}},function(e,t,n){"use strict";e.exports=function(e){var t="[object HTMLDivElement]"===Object.prototype.toString.call(e.config.el)?e.config.el:document.querySelectorAll(e.config.el)[0];"[object HTMLDivElement]"===Object.prototype.toString.call(t)&&(e.el=t,e.el.classList.add("MiniValine"),e.el.classList.add("markdown-body"),e.el.innerHTML=e.ele)}},function(e,t,n){"use strict";var r=k(n(17)),i=k(n(18)),o=k(n(19)),a=k(n(20)),c=k(n(21)),l=k(n(23)),u=k(n(24)),s=k(n(25)),d=k(n(26)),f=k(n(5)),v=k(n(27)),p=k(n(28)),m=k(n(29)),g=k(n(30)),y=k(n(31)),h=k(n(32)),b=k(n(33)),w=k(n(34)),C=k(n(35)),x=k(n(36)),S=k(n(39)),_=k(n(40)),A=k(n(41)),q=k(n(42)),M=k(n(43));function k(e){return e&&e.__esModule?e:{default:e}}e.exports={Config:r.default,i18n:i.default,setAV:o.default,smile:a.default,script:c.default,initStyle:l.default,initLibs:u.default,uploadImage:s.default,alert:d.default,initCount:v.default,smileEvt:p.default,startEvt:m.default,resetForm:g.default,cancelReply:y.default,smileBtnEvt:h.default,previewBtnEvt:b.default,inputs:w.default,atEvt:C.default,submitBtnEvt:x.default,insertComment:S.default,nestQuery:_.default,parentQuery:A.default,ActivateCode:q.default,previewEvt:M.default,getCache:f.default}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e){e.emoticonUrl=e.config.emoticonUrl||r.EUrl,e.lang=e.config.lang||navigator.language||navigator.userLanguage,e.maxNestLevel=e.config.maxNest||r.MaxNL,e.pageSize=e.config.pageSize||r.PS,e.adminEmailMd5=e.config.adminEmailMd5||"",e.math=e.config.math,e.md=e.config.md,e.mode=e.config.mode||"DesertsP",e.placeholder=e.config.placeholder||"",e.C=r.C,e.C.url=e.config.pathname||location.pathname.replace(/\/$/,"")}},function(module,exports,__webpack_require__){"use strict";var _Default=__webpack_require__(1),_ajax=__webpack_require__(3),_ajax2=_interopRequireDefault(_ajax);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var i18n=function i18n(root){(0,_ajax2.default)({url:_Default.i18nUrl+root.lang+"/index.json",type:"GET",success:function success(data){data=eval("("+data+")"),root.i18n=data}})};module.exports=i18n},function(e,t,n){"use strict";e.exports=function(e){var t,n="https://";if(!e.config.serverURLs)switch(e.config.appId.slice(-9)){case"-9Nh9j0Va":n+="tab.";break;case"-MdYXbMMI":n+="us."}t=e.config.serverURLs||"".concat(n,"avoscloud.com"),void 0===window.disableAVInit&&(AV.init({appId:e.config.appId,appKey:e.config.appKey,serverURLs:t}),window.disableAVInit=!0),e.v=AV}},function(module,exports,__webpack_require__){"use strict";var _ajax=__webpack_require__(3),_ajax2=_interopRequireDefault(_ajax);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var smile=function(e){e.emoticonList=[],e.emoticon=[];for(var t=0;t<e.emoticonUrl.length;t++)getSmile(e,e.emoticonUrl[t])},getSmile=function getSmile(root,Url){(0,_ajax2.default)({url:Url+"/index.json",type:"GET",success:function success(data){data=eval("("+data+")");for(var i=0;i<data[0].length;i++)root.emoticonList.push(Url+"/"+data[0][i]),root.emoticon[data[0][i]]=Url+"/"+data[0][i]}})};module.exports=smile},function(e,t,n){"use strict";var r=n(1),i=a(n(7)),o=a(n(22));function a(e){return e&&e.__esModule?e:{default:e}}e.exports=function(e){e.config.NoRecordIP||((0,i.default)(r.ip),(0,o.default)(e)),(0,i.default)(r.pf)}},function(e,t,n){"use strict";e.exports=function(e){window.getIP=function(t){e.C.ip=t.ip}}},function(e,t,n){"use strict";e.exports=function(e){var t=setInterval((function(){"undefined"!=typeof Promise&&(clearInterval(t),"DesertsP"===e.mode?n.e(7).then(n.t.bind(null,46,7)):"xCss"===e.mode&&n.e(8).then(n.t.bind(null,47,7)))}),5)}},function(e,t,n){"use strict";e.exports=function(e){var t=setInterval((function(){"undefined"!=typeof Promise&&(clearInterval(t),Promise.all([n.e(9),n.e(3)]).then(n.t.bind(null,48,7)).then((function(t){(0,t.lib)(),e.initCheck()})))}),5)}},function(e,t,n){"use strict";var r=o(n(0)),i=o(n(4));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=function(e){var t=e.el.querySelector(".veditor");r.default.on("keydown",document,(function(n){var r=(n=event||n).keyCode||n.which||n.charCode;(n.ctrlKey||n.metaKey)&&13===r&&e.submitEvt(),9!==r||"veditor"==(document.activeElement.className||"")&&(n.preventDefault(),(0,i.default)(t,"    "))})),r.default.on("paste",document,(function(r){var o="clipboardData"in r?r.clipboardData:r.originalEvent&&r.originalEvent.clipboardData||window.clipboardData,a=o&&o.items,c=[];if(a&&0<a.length){for(var l=0;l<a.length;l++)if(-1!==a[l].type.indexOf("image")){c.push(a[l].getAsFile());break}if(c.length)for(var u=function(){var r=c[s],o="![Uploading ".concat(r.name,"]()");(0,i.default)(t,o),n(r,(function(n,i){!n&&i&&(t.value=t.value.replace(o,"\r\n![".concat(r.name,"](").concat(i.data,")")),e.C.comment=t.value)}))},s=0;s<c.length;s++)u()}}));var n=function(e,t){var n=new FormData;n.append("file",e);var r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){if(4===r.readyState&&200===r.status)try{var e=JSON.parse(r.responseText);t&&t(null,e)}catch(e){t&&t(e)}else t&&t(r.status)},r.onerror=function(e){console.log(e)},r.open("POST","https://imgkr.com/api/files/upload",!0),r.send(n)}}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));e.exports=function(e){var t=e.el.querySelector(".vmark");e.alert={show:function(n){t.innerHTML='<div class="valert txt-center"><div class="vtext">'.concat(n.text,'</div><div class="vbtns"></div></div>');var i=t.querySelector(".vbtns"),o='<button class="vcancel vbtn">'.concat(n.ctxt||e.i18n.cancel,"</button>"),a='<button class="vsure vbtn">'.concat(n.otxt||e.i18n.continue,"</button>");if(i.innerHTML="".concat(o).concat(n.type&&a),t.querySelector(".vcancel").addEventListener("click",(function(t){e.alert.hide()})),t.setAttribute("style","display:block;"),n.type){var c=t.querySelector(".vsure");r.default.on("click",c,(function(t){e.alert.hide(),n.cb&&n.cb()}))}},hide:function(){t.setAttribute("style","display:none;")}}}},function(e,t,n){"use strict";e.exports=function(e){var t=new e.v.Query("Comment");t.equalTo("url",e.C.url);var n=new e.v.Query("Comment");n.equalTo("url","".concat(e.C.url,"/"));var r=AV.Query.or(t,n);r.notEqualTo("isSpam",!0),r.count().then((function(t){e.el.querySelector(".count").innerHTML=t})).catch((function(t){console.log(t),e.el.querySelector(".count").innerHTML=0}))}},function(e,t,n){"use strict";var r=o(n(0)),i=o(n(4));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=function(e){var t=e.el.querySelector(".vsmile-icons");r.default.on("click",t,(function(t){var n=e.el.querySelector(".veditor"),r=t.target.src;if(void 0!==r){var o="!(:".concat(decodeURI(r).replace(/^.*\/(.*)$/,"$1"),":)");(0,i.default)(n,o),e.C.comment=n.value;var a=e.el.querySelector(".vsubmit");a.getAttribute("disabled")&&a.removeAttribute("disabled")}}))}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));e.exports=function(e){var t=e.el.querySelector(".commentTrigger");r.default.on("click",t,(function(n){t.setAttribute("style","display:none"),e.el.querySelector(".auth-section").removeAttribute("style"),e.el.querySelector(".veditor").focus()}))}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(5));e.exports=function(e){var t=e.el.querySelector(".vsmile-icons"),n=e.el.querySelector(".vpreview-text");e.reset=function(){for(var i in e.mapping)if(e.mapping.hasOwnProperty(i)){var o=e.mapping[i];e.el.querySelector(".".concat(i)).value="",e.C[o]=""}e.C.rid="",e.C.nick="",e.C.at="",(e.el.querySelector(".vinputs-area  textarea").placeholder="",r.default)(e),e.previewEvt(e),t.getAttribute("triggered")&&(t.setAttribute("style","display:none;"),t.removeAttribute("triggered")),n.getAttribute("triggered")&&(n.setAttribute("style","display:none;"),n.removeAttribute("triggered")),e.el.querySelector(".vcancel-comment-reply").setAttribute("style","display:none"),e.el.querySelector("#vinputs-placeholder").appendChild(e.el.querySelector(".vinputs-wrap"))}}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));e.exports=function(e){r.default.on("click",e.el.querySelector(".cancel-reply-btn"),(function(t){e.reset()}))}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));e.exports=function(e){var t=e.el.querySelector(".vemoji-btn"),n=e.el.querySelector(".vpreview-btn"),i=e.el.querySelector(".vpreview-text"),o=e.el.querySelector(".vsmile-icons");r.default.on("click",t,(function(e){i.getAttribute("triggered")&&(i.setAttribute("style","display:none;"),i.removeAttribute("triggered"),n.classList.remove("actived")),o.getAttribute("triggered")?(o.setAttribute("style","display:none;"),o.removeAttribute("triggered"),t.classList.remove("actived")):(o.removeAttribute("style"),o.setAttribute("triggered",1),t.classList.add("actived"))}))}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));e.exports=function(e){var t=e.el.querySelector(".vpreview-btn"),n=e.el.querySelector(".vemoji-btn"),i=e.el.querySelector(".vpreview-text"),o=e.el.querySelector(".vsmile-icons");r.default.on("click",t,(function(r){if(o.getAttribute("triggered")&&(o.setAttribute("style","display:none;"),o.removeAttribute("triggered"),n.classList.remove("actived")),i.getAttribute("triggered"))i.setAttribute("style","display:none;"),i.removeAttribute("triggered"),t.classList.remove("actived");else{if(t.classList.add("actived"),""===e.C.comment)return void e.inputs.comment.focus();e.previewEvt(e)}}))}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));e.exports=function(e){for(var t in e.inputs={},e.mapping={veditor:"comment",vnick:"nick",vlink:"link",vmail:"mail"},e.mapping)e.mapping.hasOwnProperty(t)&&function(){var n=e.mapping[t],i=e.el.querySelector(".".concat(t));e.inputs[n]=i,r.default.on("input",i,(function(t){e.C[n]=i.value,e.previewEvt(e)}))}()}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));e.exports=function(e){e.AtEvt=function(t){var n=t.getAttribute("id"),i=t.querySelector("#at-".concat(n));r.default.on("click",i,(function(r){var o=i.getAttribute("at"),a=i.getAttribute("rid");e.C.rid=a,e.C.at=o,e.el.querySelector(".vinputs-area  textarea").placeholder=o,e.inputs.comment.value="".concat(e.inputs.comment.value),t.querySelector("#comment-".concat(n)).appendChild(e.el.querySelector(".vinputs-wrap")),e.el.querySelector(".vcancel-comment-reply").removeAttribute("style"),"DesertsP"===e.mode&&(e.el.querySelector(".commentTrigger").setAttribute("style","display:none"),e.el.querySelector(".auth-section").removeAttribute("style"),e.el.querySelector(".veditor").focus()),e.inputs.comment.focus()}))}}},function(e,t,n){"use strict";var r=a(n(0)),i=a(n(6)),o=a(n(38));function a(e){return e&&e.__esModule?e:{default:e}}e.exports=function(e){var t=e.el.querySelector(".vsubmit");e.submitEvt=function(r){if(t.getAttribute("disabled"))e.alert.show({type:0,text:e.i18n.wait+'ã¾(à¹â¹â¡â¹)ï¾"',ctxt:e.i18n.ok});else if(""!==e.C.comment)if(""!==e.C.nick){(0,i.default)(e,e,(function(e){if(e.C.comment=e.TEXT,""!==e.C.at){var t='<a class="at" href=\'#'.concat(e.C.rid,"'>").concat(e.C.at,"</a>");e.C.comment=t+" , "+e.C.comment}var r=o.default.mail(e.C.mail),i=o.default.link(e.C.link);e.C.mail=r.k?r.v:"",e.C.link=i.k?i.v:"",r.k&&i.k?n():e.alert.show({type:0,text:e.i18n.inputTips,ctxt:e.i18n.confirm})}))}else e.inputs.nick.focus();else e.inputs.comment.focus()};var n=function(){t.setAttribute("disabled",!0),e.submitting.show();var n=new(e.v.Object.extend("Comment"));for(var r in e.C)if(e.C.hasOwnProperty(r)){if("at"===r)continue;var i=e.C[r];n.set(r,i)}n.set("emailHash",md5(e.C.mail.toLowerCase().trim())),n.setACL(function(){var t=new e.v.ACL;return t.setPublicReadAccess(!0),t.setPublicWriteAccess(!1),t}()),n.save().then((function(n){localStorage&&localStorage.setItem("MiniValineCache",JSON.stringify({nick:e.C.nick,link:e.C.link,mail:e.C.mail}));var r=e.el.querySelector(".count");if(r.innerText=Number(r.innerText)+1,""===e.C.rid)e.insertComment(n,null,!0);else{var i=e.el.querySelector("#children-list-".concat(e.C.rid));e.insertComment(n,i,!0)}t.removeAttribute("disabled"),e.submitting.hide(),e.nodata.hide(),e.reset()})).catch((function(t){e.submitting.hide()}))};r.default.on("click",t,e.submitEvt)}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2));e.exports=function(e,t,i){e.md||void 0===e.config.md?Promise.all([n.e(10),n.e(5)]).then(n.t.bind(null,49,7)).then((function(e){var n=e.markdown;t.TEXT=n(t.TEXT),(0,r.default)(t,i)})):(0,r.default)(t,i)}},function(e,t,n){"use strict";e.exports={mail:function(e){return{k:/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e),v:e}},link:function(e){return 0<e.length&&(e=/^(http|https)/.test(e)?e:"http://".concat(e)),{k:!(0<e.length)||/(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/.test(e),v:e}}}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));e.exports=function(e,t){e.insertComment=function(r){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,o=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],a=document.createElement("li");a.setAttribute("class","vcard"),a.setAttribute("id",r.id),a.innerHTML=t.vcard(e,r),e.ActivateCode(e);for(var c=i||e.el.querySelector(".vlist"),l=c.querySelectorAll("li"),u=a.querySelectorAll("a"),s=0,d=u.length;s<d;s++){var f=u[s];f&&"at"!==f.getAttribute("class")&&(f.setAttribute("target","_blank"),f.setAttribute("rel","nofollow"))}o?c.insertBefore(a,l[0]):c.appendChild(a);var v=a.querySelector(".vcomment");return n(v),e.AtEvt(a),a};var n=function(e){180<e.offsetHeight&&(e.classList.add("expand"),r.default.on("click",e,(function(t){e.setAttribute("class","vcomment")})))}}},function(e,t,n){"use strict";var r=o(n(0)),i=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=function(e){e.nestQuery=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,o=t.querySelector(".vcomment-children"),a=o.querySelector(".vlist"),c=t.getAttribute("id");n<=0&&o.setAttribute("style","margin-left: 0 !important"),n>=e.maxNestLevel?e.v.Query.doCloudQuery("select count(*) from Comment where rid='".concat(c,"' and (url='").concat(e.C.url,"' or url='","".concat(e.C.url,"/"),"') order by -createdAt")).then((function(n){if(0<n.count){var i=o.querySelector(".vshow-children-wrapper");i.setAttribute("style","display: block !important;"),i.innerHTML='<span class="vshow-children" rid="'.concat(c,'">').concat(e.i18n.more,"</span>");var a=i.querySelector(".vshow-children");r.default.on("click",a,(function(n){i.setAttribute("style","display: none !important;"),e.nestQuery(t,-1e3)}))}}),(function(e){console.log(e)})):e.v.Query.doCloudQuery("select nick, comment, link, rid, emailHash, isSpam,mail from Comment where rid='".concat(c,"' and (url='").concat(e.C.url,"' or url='","".concat(e.C.url,"/"),"') order by -createdAt")).then((function(t){var r=(t=t&&t.results||[]).length;if(r)for(var o=function(r){if(!t[r].get("isSpam")){t[r].TEXT=t[r].get("comment"),(0,i.default)(t[r],(function(i){t[r].set("comment",i.TEXT);var o=e.insertComment(t[r],a,!0);e.nestQuery(o,n+1)}))}},c=0;c<r;c++)o(c)})).catch((function(t){console.log(t),e.loading.hide(e.parentCount)}))}}},function(e,t,n){"use strict";var r=o(n(0)),i=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=function(e){var t=1;e.parentCount=0,e.parentQuery=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;e.loading.show(),e.v.Query.doCloudQuery("select nick, comment, link, rid, emailHash, isSpam,mail from Comment where (rid='' or rid is not exists) and (url='".concat(e.C.url,"' or url='","".concat(e.C.url,"/"),"') order by -createdAt limit ").concat((n-1)*e.pageSize,",").concat(e.pageSize)).then((function(o){var a=(o=o&&o.results||[]).length;if(a){for(var c=function(t){if(o[t].get("isSpam"))return"continue";o[t].TEXT=o[t].get("comment"),(0,i.default)(o[t],(function(n){o[t].set("comment",n.TEXT);var r=e.insertComment(o[t],e.el.querySelector(".vlist"),!1);r.setAttribute("style","margin-bottom: .5em"),e.nestQuery(r)}))},l=0;l<a;l++)c(l);var u=e.el.querySelector(".vpage");u.innerHTML=e.pageSize*n<e.parentCount?'<div id="vmore" class="more">'.concat(e.i18n.more,"</div>"):"";var s=u.querySelector("#vmore");s&&r.default.on("click",s,(function(n){u.innerHTML="",e.parentQuery(++t)}))}e.loading.hide(e.parentCount)})).catch((function(t){console.log(t),e.loading.hide(e.parentCount)}))},e.v.Query.doCloudQuery("select count(*) from Comment where (rid='' or rid is not exists) and (url='".concat(e.C.url,"' or url='","".concat(e.C.url,"/"),"') order by -createdAt")).then((function(t){e.parentCount=t.count,e.parentQuery(1)})).catch((function(e){console.log(e)}))}},function(e,t,n){"use strict";e.exports=function(e){e.ActivateCode=function(e){setTimeout((function(){document.getElementsByTagName("pre").length&&n.e(6).then(n.t.bind(null,51,7))}),500),0!=e.math&&n.e(4).then(n.t.bind(null,52,7)).then((function(t){(0,t.MathJaxSupport)(e)}))}}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(6));e.exports=function(e){e.previewEvt=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=e.el.querySelector(".vpreview-btn"),i=e.el.querySelector(".vpreview-text"),o=e.el.querySelector(".veditor"),a=function(r){r.innerHTML=r.TEXT,r.removeAttribute("style"),r.setAttribute("triggered",1),n.classList.add("actived"),o.value?autosize(o):autosize.destroy(o),e.ActivateCode(e,t)};(0,r.default)(e,i,a)}}}])}));