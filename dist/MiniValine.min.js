!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("MiniValine",[],e):"object"==typeof exports?exports.MiniValine=e():t.MiniValine=e()}(window,(function(){return function(t){function e(e){for(var n,o,r=e[0],a=e[1],c=0,s=[];c<r.length;c++)o=r[c],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&s.push(i[o][0]),i[o]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n]);for(l&&l(e);s.length;)s.shift()()}var n={},i={0:0};function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,o){n=i[t]=[e,o]}));e.push(n[2]=r);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=function(t){return o.p+"MiniValine."+({1:"lib",2:"math",3:"md",4:"md-style",5:"style",6:"vendors~lib",7:"vendors~md",8:"vendors~xss",9:"xss"}[t]||t)+".min.js"}(t);var l=new Error;a=function(e){c.onerror=c.onload=null,clearTimeout(s);var n=i[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",l.name="ChunkLoadError",l.type=o,l.request=r,n[1](l)}i[t]=void 0}};var s=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(e)},o.m=t,o.c=n,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="https://unpkg.com/minivaline@1.2.31/dist/",o.oe=function(t){throw console.error(t),t};var r=window.webpackJsonpMiniValine=window.webpackJsonpMiniValine||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var l=a;return o(o.s=8)}([function(t,e,n){"use strict";var i={on:function(t,e,n,o){for(var r=0,a=(t=t.split(" ")).length;r<a;r++)i.off(t[r],e,n,o),e.addEventListener?e.addEventListener(t[r],n,o||!1):e.attachEvent?e.attachEvent("on".concat(t[r]),n):e["on".concat(t[r])]=n},off:function(t,e,n,i){for(var o=0,r=(t=t.split(" ")).length;o<r;o++)e.removeEventListener?e.removeEventListener(t,n,i||!1):e.detachEvent?e.detachEvent("on".concat(t),n):e["on".concat(t)]=null}};t.exports=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.VERSION="1.2.31",e.AVSdkUrl="https://cdn.jsdelivr.net/npm/leancloud-storage@3/dist/av-min.js",e.GravatarBaseUrl="https://gravatar.loli.net/avatar/",e.ip="https://api.ip.sb/jsonip?callback=getIP",e.EmoticonUrl="https://cdn.jsdelivr.net/npm/alus",e.i18nUrl="https://cdn.jsdelivr.net/gh/MiniValine/minivaline-i18n@master/",e.DefaultEmailHash="9e63c80900d106cbbec5a9f4ea433a3e",e.MaxNestLevel=3,e.PageSize=6,e.Comment={ip:"",comment:"",rid:"",at:"",nick:"",mail:"",link:"",ua:navigator.userAgent,url:location.pathname,pin:0}},function(t,e,n){"use strict";t.exports=function(t,e){Promise.all([n.e(8),n.e(9)]).then(n.t.bind(null,47,7)).then((function(n){var i=n.XSS;t.TEXT=i(t.TEXT),e(t)}))}},function(t,e,n){"use strict";t.exports=function(t){"undefined"!=typeof MathJax||!t.math&&void 0!==t.config.math||n.e(2).then(n.t.bind(null,48,7)).then((function(t){(0,t.initMathJax)()})),"undefined"!=typeof MathJax&&setTimeout((function(){MathJax.Hub.Typeset(document.getElementsByClassName("MiniValine"))}),200)}},function(t,e,n){"use strict";var i=function(t){var e=[];for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.push(("v="+Math.random()).replace(".","")),e.join("&")};t.exports=function(t){(t=t||{}).type=(t.type||"GET").toUpperCase(),t.dataType=t.dataType||"json";var e=i(t.data);if(window.XMLHttpRequest)var n=new XMLHttpRequest;else n=new ActiveXObject("Microsoft.XMLHTTP");n.onreadystatechange=function(){if(4==n.readyState){var e=n.status;e>=200&&e<300?t.success&&t.success(n.responseText,n.responseXML):t.fail&&t.fail(e)}},"GET"==t.type?(n.open("GET",t.url+"?"+e,!0),n.send(null)):"POST"==t.type&&(n.open("POST",t.url,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(e))}},function(t,e,n){"use strict";t.exports=function(t,e){if(document.selection)t.focus(),document.selection.createRange().text=e,t.focus();else if(t.selectionStart||"0"==t.selectionStart){var n=t.selectionStart,i=t.selectionEnd,o=t.scrollTop;t.value=t.value.substring(0,n)+e+t.value.substring(i,t.value.length),t.focus(),t.selectionStart=n+e.length,t.selectionEnd=n+e.length,t.scrollTop=o}else t.focus(),t.value+=e}},function(t,e,n){"use strict";var i=n(1);t.exports=function(t){var e=localStorage&&localStorage.getItem("MiniValineCache");if(e){e=JSON.parse(e);for(var n=["nick","link","mail"],o=0;o<n.length;o++){var r=n[o];t.el.querySelector(".v".concat(r)).value=e[r],t.Comment[r]=e[r]}if(""!==e.mail)t.el.querySelector(".visitor_avatar").setAttribute("data-src","".concat(i.GravatarBaseUrl+md5(e.mail.toLowerCase().trim()),"?size=80&d=https%3a%2f%2fgravatar.loli.net%2favatar%2f9e63c80900d106cbbec5a9f4ea433a3e.jpg%3fsize%3d80"))}}},function(t,e,n){"use strict";var i,o=n(36),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t,e,n){e.TEXT=t.Comment.comment.replace(/!\(:(.*?\.\w+):\)/g,'<img src="'.concat(t.emoticonUrl,'/$1" alt="$1" class="vemoticon-img">')),(0,r.default)(t,e,n)}},function(t,e,n){"use strict";var i,o=n(9),r=(i=o)&&i.__esModule?i:{default:i},a=n(1);var c=function(t){return console.log("%c MiniValine %c v"+a.VERSION+" ","color: white; background: #0078E7; padding:5px 0;","padding:4px;border:1px solid #0078E7;"),new r.default(t)};t.exports=c,t.exports.default=c},function(t,e,n){"use strict";var i=r(n(10)),o=r(n(18));function r(t){return t&&t.__esModule?t:{default:t}}var a=function(t){this.config=t,o.default.initStyle(),o.default.Config(this),o.default.script(this),o.default.i18n(this),o.default.smile(this),o.default.GetIP(this),o.default.initLibs(this)};a.prototype.initCheck=function(){var t=this,e=setInterval((function(){void 0!==t.i18n&&"undefined"!=typeof AV&&(clearInterval(e),t.initBody())}),5)},a.prototype.initBody=function(){try{i.default.el(this),i.default.loading(this),this.nodata.show(),i.default.smiles(this),o.default.setAV(this)}catch(t){return void console.log(t)}this.loading.hide(this.parentCount),o.default.alert(this),this.loading.show(),o.default.initCount(this),this.bind()},a.prototype.bind=function(){o.default.inputs(this),o.default.smileEvt(this),o.default.startEvt(this),o.default.getCache(this),o.default.resetForm(this),o.default.uploadImage(this),o.default.cancelReply(this),o.default.smileBtnEvt(this),o.default.previewBtnEvt(this),o.default.atEvt(this),o.default.submitBtnEvt(this),o.default.insertComment(this,i.default),o.default.parentQuery(this),o.default.nestQuery(this)},t.exports=a},function(t,e,n){"use strict";var i=c(n(11)),o=c(n(13)),r=c(n(14)),a=c(n(15));function c(t){return t&&t.__esModule?t:{default:t}}t.exports={vcard:i.default,loading:o.default,smiles:r.default,el:a.default}},function(t,e,n){"use strict";var i,o=n(1),r=n(12),a=(i=r)&&i.__esModule?i:{default:i};t.exports=function(t,e){var n=e.get("emailHash"),i="".concat(o.GravatarBaseUrl+n,"?size=80&d=https%3a%2f%2fgravatar.loli.net%2favatar%2f9e63c80900d106cbbec5a9f4ea433a3e.jpg%3fsize%3d80");return'<div class="vcomment-body"><div class="vhead" >'+'<img class="vavatar lazyload" data-src="'.concat(i,'"/>')+"<a rid='".concat(e.id,"' at='@").concat(e.get("nick"),'\' class="vat" id="at-').concat(e.id,'">').concat(t.i18n.reply,"</a>")+'<div class="vmeta-info">'.concat(e.get("link")?'<a class="vname" href="'.concat(e.get("link"),'" target="_blank" rel="nofollow" > ').concat(e.get("nick"),"</a>"):'<span class="vname">'.concat(e.get("nick"),"</span>")).concat(n===t.adminEmailMd5.toLowerCase().trim()?'<span class="spacer">Â·</span><span class="vtime"><svg xmlns:xlink="http://www.w3.org/1999/xlink" p-id="1615" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024" style="height: .8em;width: .8em;fill: #777;" class="icon" t="1559101574545"><defs><style type="text/css"></style></defs><path d="M582.044306 993.554603l17.113098-99.494753-72.233191-70.442285c-25.072678-24.27672-34.027206-57.109988-24.07773-87.555383 9.949475-30.445394 36.41508-51.538282 70.840264-56.51302l87.356393-12.735328c-3.780801-2.586864-7.163622-5.173727-10.347454-7.95958-10.944423-9.551496-18.705014-19.699961-23.480762-30.047415s-7.561601-21.092888-8.15857-31.440342c-0.596969-10.546444 0-20.893898 1.989895-31.042363 1.392927-8.15857 3.581811-15.123202 6.168675-20.893898 2.586864-5.770696 5.969685-10.546444 10.148465-14.725223 4.17878-3.97979 8.755538-7.95958 14.327244-11.541391 5.571706-3.780801 11.143412-8.15857 17.312087-13.730276 5.372717-4.775748 10.148465-11.342402 14.725223-19.898951 4.17878-8.357559 8.15857-17.113098 11.541391-25.868636 3.382822-9.949475 6.566654-20.694909 9.153517-31.440342 6.765643-1.989895 13.133307-5.571706 19.301982-11.143412 5.372717-4.775748 10.148465-11.342402 14.725223-19.898951 4.17878-8.556549 7.561601-19.699961 9.551496-34.027206 1.392927-10.944423 1.193937-19.898951-0.397979-27.460552-1.591916-7.561601-3.97979-13.531286-6.566654-18.307035-2.586864-5.571706-6.367664-9.750486-11.143412-12.337349 0.596969-27.062573-0.994948-54.324135-5.173727-81.386708-3.183832-23.082783-9.153517-47.558492-17.710066-73.626117s-21.291877-49.946366-38.205985-71.636222c-7.561601-9.551496-17.312087-18.904003-29.649436-28.05752-11.93937-9.153517-26.067625-17.312087-41.588807-24.873688-15.720171-7.561601-32.43529-13.531286-50.344345-18.307035s-37.012048-7.163622-56.51302-7.163622c-15.720171 0-31.838321 1.591916-48.35445 4.17878-16.715119 2.984843-33.032258 7.561601-49.349398 14.327244-16.31714 6.765643-32.43529 16.11815-48.35445 28.05752s-30.246405 27.062573-43.180723 45.369607c-13.531286 19.500972-23.878741 41.588807-31.042363 66.064516-7.163622 24.475709-12.13836 47.558492-14.725223 69.248348-3.581811 25.868636-4.775748 51.737272-4.17878 77.406918-5.571706 6.964633-9.750486 13.929265-12.337349 21.490867-2.785853 6.765643-4.576759 14.725223-5.571706 23.878741-1.193937 9.153517 0 19.699961 3.382822 31.042363 3.581811 11.541391 7.561601 20.29693 12.337349 26.465604 4.775748 6.168675 9.153517 10.944423 13.332297 14.327244 4.775748 3.581811 9.551496 5.770696 14.327244 7.163622 3.382822 10.745433 6.765643 21.291877 10.148465 31.440342 3.382822 8.755538 6.964633 17.312087 11.143412 25.868636 4.17878 8.556549 8.755538 15.123202 14.327244 19.898951 11.740381 9.551496 21.888846 18.705014 31.042363 27.460552 9.153517 8.755538 14.327244 21.291877 15.720171 37.609017 0.596969 10.347454 0.994948 19.898951 0.994948 28.654489 0 8.954528-1.591916 17.312087-4.576759 25.470657-2.984843 8.15857-8.556549 16.31714-16.31714 24.475709-7.760591 8.15857-18.705014 16.715119-33.032258 25.470657-17.511077 11.541391-38.006996 20.29693-61.487757 26.465604-23.480762 6.168675-125.761368 41.389817-147.849203 48.951419-21.888846 7.362612-41.190828 17.511077-57.507967 30.445394-16.11815 12.735328-26.266615 31.838321-30.445394 56.910999C2.387875 881.52351 0.994949 888.488143 4.57676 916.346674c3.581811 27.659541 9.153517 44.17567 16.715119 49.747377 6.168675 4.576759 23.679751 10.148465 52.931209 16.715119 29.251457 6.566654 213.11776 41.190828 426.633501 41.190828 27.858531 0 54.722114-0.596969 80.59075-1.790906C580.253401 1012.856585 580.45239 1003.305088 582.044306 993.554603z" p-id="1616"></path><path d="M1004.300038 748.399532l-106.459386-15.521182c-16.31714-2.387874-35.619122-16.31714-42.981733-31.241353l-47.558492-96.509911c-3.581811-7.362612-8.556549-11.143412-13.332297-11.143412-4.775748 0-9.551496 3.780801-13.332297 11.143412l-47.558492 96.509911c-7.362612 14.725223-26.664594 28.853478-42.981733 31.241353l-106.459386 15.521182c-16.31714 2.387874-20.09794 13.730276-8.15857 25.271667l77.008939 75.019044c11.740381 11.541391 19.102993 34.226195 16.31714 50.543335l-18.108045 106.061407c-1.989895 11.740381 2.586864 18.705014 10.745433 18.705014 3.183832 0 6.765643-0.994948 10.745433-3.183832l95.116984-50.145356c7.362612-3.780801 16.914108-5.770696 26.465604-5.770696 9.551496 0 19.301982 1.989895 26.465604 5.770696l95.116984 50.145356c3.97979 2.188885 7.760591 3.183832 10.745433 3.183832 8.15857 0 12.735328-6.964633 10.745433-18.705014l-18.108045-106.061407c-2.785853-16.31714 4.576759-39.001943 16.31714-50.543335l77.008939-75.019044C1024.198988 762.129808 1020.617177 750.787406 1004.300038 748.399532z" p-id="1617"></path></svg></span><span class="spacer">Â·</span>':'<span class="spacer">Â·</span>')+'<span class="vtime">'.concat((0,a.default)(e.get("createdAt"),t.i18n),"</span>")+"</div></div>"+'<section class="text-wrapper"  id="comment-'.concat(e.id,'">')+'<div class="vcomment">'.concat(e.get("comment"),"</div>")+'</section></div><div class="vcomment-children"><div class="vshow-children-wrapper" style="display: none"></div>'+'<ul class="vlist" id="children-list-'.concat(e.id,'"></ul>')+"</div>"}},function(t,e,n){"use strict";var i=function(t){var e=o(t.getDate(),2),n=o(t.getMonth()+1,2),i=o(t.getFullYear(),2);return"".concat(i,"-").concat(n,"-").concat(e)},o=function(t,e){for(var n=t.toString();n.length<e;)n="0".concat(n);return n};t.exports=function(t,e){try{var n=t.getTime(),o=(new Date).getTime()-n,r=Math.floor(o/864e5);if(0===r){var a=o%864e5,c=Math.floor(a/36e5);if(0===c){var l=a%36e5,s=Math.floor(l/6e4);if(0===s){var u=l%6e4,d=Math.round(u/1e3);return 0===d?e.now:"".concat(d," ").concat(e.seconds)}return"".concat(s," ").concat(e.minutes)}return"".concat(c," ").concat(e.hours)}return r<0?e.now:r<365?"".concat(r," ").concat(e.days):i(t)}catch(t){console.log(t)}}},function(t,e,n){"use strict";t.exports=function(t){var e=t.el.querySelector(".vempty");t.nodata={show:function(n){e.innerHTML=n||t.i18n.noCommentYet,e.setAttribute("style","display:block;")},hide:function(){e.setAttribute("style","display:none;")}};var n='<div class="spinner"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div><div class="r5"></div></div>',i=t.el.querySelector(".vloading");i.innerHTML=n,t.loading={show:function(){i.setAttribute("style","display:block;"),t.nodata.hide()},hide:function(e){i.setAttribute("style","display:none;"),0===e&&t.nodata.show()}};var o=t.el.querySelector(".vsubmitting");o.innerHTML=n,t.submitting={show:function(){o.setAttribute("style","display:block;")},hide:function(){o.setAttribute("style","display:none;"),t.nodata.hide()}}}},function(t,e,n){"use strict";t.exports=function(t){var e=setInterval((function(){if(void 0!==t.emoticonList){clearInterval(e);var n=t.el.querySelector(".vsmile-icons"),i=t.emoticonList||[];for(var o in i)if(i.hasOwnProperty(o)){var r=document.createElement("img");r.setAttribute("data-src","".concat(t.emoticonUrl,"/").concat(i[o])),r.setAttribute("class","lazyload"),n.appendChild(r)}}}),10)}},function(t,e,n){"use strict";var i,o=n(16),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t){var e="[object HTMLDivElement]"===Object.prototype.toString.call(t.config.el)?t.config.el:document.querySelectorAll(t.config.el)[0];"[object HTMLDivElement]"===Object.prototype.toString.call(e)&&(t.el=e,t.el.classList.add("MiniValine"),t.el.innerHTML=(0,r.default)(t))}},function(t,e,n){"use strict";var i,o=n(1),r=n(17),a=(i=r)&&i.__esModule?i:{default:i};t.exports=function(t){return'<div id="vinputs-placeholder"><div class="vinputs-wrap">'+'<p class="vcancel-comment-reply" href="#" rel="nofollow" style="display:none">'.concat(t.i18n.cancelReply,"</p>")+'<div class="vinputs-area"><div class="textarea-wrapper"><div class="commentTrigger">'+'<div class="avatar"><img class="visitor_avatar lazyload" data-src="'.concat("".concat(o.GravatarBaseUrl+o.DefaultEmailHash,"?size=80"),'"></div>')+'<div class="trigger_title">'.concat(t.placeholder,"</div>")+'</div><div class="veditor-area"><textarea placeholder="" class="veditor"></textarea><div class="btn-wrap">'+'<div class="vpreview-btn vfunction-btn" title="'.concat(t.i18n.preview,'">')+'<svg t="1551146416896" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2051" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.5em" height="1.5em"><defs><style type="text/css"></style></defs><path d="M862.516 161.07l44.62 44.38-286.303 288.866-45.668-45.615L862.516 161.07z m1.233 1.233" p-id="2052"></path><path d="M832.162 959.558H128.025V191.784h512.099v64.169H192.037V895.64h576.112V512.127h64.012v447.431z m0.833 0.533" p-id="2053"></path><path d="M256.05 703.994h384.075v63.919H256.05v-63.919z m0-127.769l320.062-0.069v63.919H256.05v-63.85z m0-128.317h192.037v63.891l-192.037 0.028v-63.919z m0 0" p-id="2054"></path></svg></div>'+'<div class="vemoji-btn vfunction-btn" title="'.concat(t.i18n.emoji,'">')+'<svg t="1551146424708" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2169" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.5em" height="1.5em"><defs><style type="text/css"></style></defs><path d="M513.028 63.766c-247.628 0-448.369 200.319-448.369 447.426S265.4 958.617 513.028 958.617s448.369-200.319 448.369-447.426S760.655 63.766 513.028 63.766z m-0.203 823.563c-207.318 0-375.382-167.71-375.382-374.592s168.064-374.592 375.382-374.592 375.382 167.71 375.382 374.592-168.064 374.592-375.382 374.592z" p-id="2170"></path><path d="M514.029 767.816c-99.337 0-188.031-54.286-251.889-146.146-10.647-16.703-7.1-33.399 7.094-45.93 14.192-12.529 28.384-8.349 39.025 8.349 49.67 75.164 124.174 116.92 205.77 116.92s163.199-45.93 209.316-125.268c10.647-16.703 24.833-16.703 39.025-8.349 14.194 12.524 14.194 29.227 7.094 45.93-60.312 96.035-152.553 154.494-255.435 154.494zM464.292 402.959l-45.151-45.151-0.05 0.05-90.45-90.45-45.15 45.15 90.45 90.45-90.45 90.451 45.15 45.15 90.45-90.45 0.05 0.05 45.151-45.151-0.05-0.05zM556.611 402.959l45.151-45.151 0.05 0.05 90.45-90.45 45.15 45.15-90.45 90.45 90.45 90.451-45.15 45.15-90.45-90.45-0.05 0.05-45.151-45.151 0.05-0.05z" p-id="2171"></path></svg></div></div></div><div class="vextra-area"><div class="vsmile-icons" style="display:none"></div><div class="vpreview-text" style="display:none"></div></div></div><section class="auth-section" style="display:none;">'+'<div class="input-wrapper"><input type="text" name="author" class="vnick" placeholder="'.concat(t.i18n.nick,'" value=""></div>')+'<div class="input-wrapper"><input type="email" name="email" class="vmail" placeholder="'.concat(t.i18n.mail,'" value=""></div>')+'<div class="input-wrapper"><input type="text" name="website" class="vlink" placeholder="'.concat(t.i18n.link,'" value=""></div>')+'<div class="post-action"><button type="button" class="vsubmit">'.concat(t.i18n.reply,"</button></div>")+'</section><div style="display:none;" class="vmark"></div></div><div class="vsubmitting" style="display:none;"></div></div></div><div class="info">'+'<div class="col"> '.concat((0,a.default)(t.i18n.commentCount,'<span class="count">0</span>'),"</div>")+'</div><ul class="vlist"><li class="vempty"></li></ul><div class="vloading"></div><div class="vpage txt-center"></div>'}},function(t,e,n){(function(e){"use strict";function n(t){var e=new Error(t);return e.name="ValueError",e}function i(t){return function(e){var i=Array.prototype.slice.call(arguments,1),o=0,r="UNDEFINED";return e.replace(/([{}])\1|[{](.*?)(?:!(.+?))?[}]/g,(function(e,a,c,l){if(null!=a)return a;var s=c;if(s.length>0){if("IMPLICIT"===r)throw n("cannot switch from implicit to explicit numbering");r="EXPLICIT"}else{if("EXPLICIT"===r)throw n("cannot switch from explicit to implicit numbering");r="IMPLICIT",s=String(o),o+=1}var u=s.split("."),d=(/^\d+$/.test(u[0])?u:["0"].concat(u)).reduce((function(t,e){return t.reduce((function(t,n){return null!=n&&e in Object(n)?["function"==typeof n[e]?n[e]():n[e]]:[]}),[])}),[i]).reduce((function(t,e){return e}),"");if(null==l)return d;if(Object.prototype.hasOwnProperty.call(t,l))return t[l](d);throw n('no transformer named "'+l+'"')}))}}var o=i({});o.create=i,o.extend=function(t,n){var o=i(n);t.format=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),o.apply(e,t)}},t.exports=o}).call(this,this)},function(t,e,n){"use strict";var i=k(n(19)),o=k(n(20)),r=k(n(21)),a=k(n(22)),c=k(n(23)),l=k(n(24)),s=k(n(25)),u=k(n(26)),d=k(n(27)),f=k(n(28)),v=k(n(6)),m=k(n(29)),p=k(n(30)),h=k(n(31)),y=k(n(32)),g=k(n(33)),b=k(n(34)),w=k(n(35)),x=k(n(37)),C=k(n(38)),_=k(n(39)),S=k(n(41)),A=k(n(42)),M=k(n(43));function k(t){return t&&t.__esModule?t:{default:t}}t.exports={Config:i.default,i18n:o.default,GetIP:r.default,setAV:a.default,smile:c.default,script:l.default,initStyle:s.default,initLibs:u.default,uploadImage:d.default,alert:f.default,initCount:m.default,smileEvt:p.default,startEvt:h.default,resetForm:y.default,cancelReply:g.default,smileBtnEvt:b.default,previewBtnEvt:w.default,inputs:x.default,atEvt:C.default,submitBtnEvt:_.default,insertComment:S.default,nestQuery:A.default,parentQuery:M.default,getCache:v.default}},function(t,e,n){"use strict";var i=n(1);t.exports=function(t){t.emoticonUrl=t.config.emoticonUrl||i.EmoticonUrl,t.lang=t.config.lang||navigator.language||navigator.userLanguage,t.maxNestLevel=t.config.maxNest||i.MaxNestLevel,t.pageSize=t.config.pageSize||i.PageSize,t.adminEmailMd5=t.config.adminEmailMd5||"",t.math=t.config.math,t.md=t.config.md,t.placeholder=t.config.placeholder||"",t.Comment=i.Comment,t.Comment.url=t.config.pathname||location.pathname.replace(/\/$/,"")}},function(module,exports,__webpack_require__){"use strict";var _Default=__webpack_require__(1),_ajax=__webpack_require__(4),_ajax2=_interopRequireDefault(_ajax);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var i18n=function i18n(root){(0,_ajax2.default)({url:_Default.i18nUrl+root.lang+"/index.json",type:"GET",success:function success(data){data=eval("("+data+")"),root.i18n=data}})};module.exports=i18n},function(t,e,n){"use strict";t.exports=function(t){window.getIP=function(e){t.Comment.ip=e.ip}}},function(t,e,n){"use strict";t.exports=function(t){void 0===window.disableAVInit&&(AV.init({appId:t.config.appId,appKey:t.config.appKey}),window.disableAVInit=!0),t.v=AV}},function(module,exports,__webpack_require__){"use strict";var _Default=__webpack_require__(1),_ajax=__webpack_require__(4),_ajax2=_interopRequireDefault(_ajax);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var smile=function smile(root){(0,_ajax2.default)({url:_Default.EmoticonUrl+"/index.json",type:"GET",success:function success(data){data=eval("("+data+")"),root.emoticonList=data[0]}})};module.exports=smile},function(t,e,n){"use strict";var i=n(1),o=function(t){var e=document.createElement("script");e.type="text/javascript",e.src=t,document.getElementsByTagName("head")[0].appendChild(e)};t.exports=function(t){o(i.AVSdkUrl),o(i.ip),(window.ActiveXObject||"ActiveXObject"in window)&&(t.config.md=!1,o("https://cdn.polyfill.io/v2/polyfill.min.js?features=es6"))}},function(t,e,n){"use strict";t.exports=function(){var t=setInterval((function(){"undefined"!=typeof Promise&&(clearInterval(t),n.e(5).then(n.t.bind(null,44,7)))}),5)}},function(t,e,n){"use strict";t.exports=function(t){Promise.all([n.e(6),n.e(1)]).then(n.t.bind(null,45,7)).then((function(e){(0,e.lib)(),t.initCheck()}))}},function(t,e,n){"use strict";var i=r(n(0)),o=r(n(5));function r(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){var e=t.el.querySelector(".veditor");i.default.on("keydown",document,(function(n){var i=(n=event||n).keyCode||n.which||n.charCode;((n.ctrlKey||n.metaKey)&&13===i&&t.bind.submitEvt(),9===i)&&("veditor"==(document.activeElement.className||"")&&(n.preventDefault(),(0,o.default)(e,"    ")))})),i.default.on("paste",document,(function(i){var r="clipboardData"in i?i.clipboardData:i.originalEvent&&i.originalEvent.clipboardData||window.clipboardData,a=r&&r.items,c=[];if(a&&a.length>0){for(var l=0;l<a.length;l++)if(-1!==a[l].type.indexOf("image")){c.push(a[l].getAsFile());break}if(c.length)for(var s=function(){var i=c[u],r="![Uploading ".concat(i.name,"]()");(0,o.default)(e,r),n(i,(function(n,o){!n&&o&&(e.value=e.value.replace(r,"\r\n![".concat(i.name,"](").concat(o.data,")")),t.Comment.comment=e.value)}))},u=0;u<c.length;u++)s()}}));var n=function(t,e){var n=new FormData;n.append("file",t);var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");i.onreadystatechange=function(){if(4==i.readyState&&200==i.status)try{var t=JSON.parse(i.responseText);e&&e(null,t)}catch(t){e&&e(t)}else e&&e(i.status)},i.onerror=function(t){console.log(t)},i.open("POST","https://imgkr.com/api/files/upload",!0),i.send(n)}}},function(t,e,n){"use strict";var i,o=n(0),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t){var e=t.el.querySelector(".vmark");t.alert={show:function(n){e.innerHTML='<div class="valert txt-center"><div class="vtext">'.concat(n.text,'</div><div class="vbtns"></div></div>');var i=e.querySelector(".vbtns"),o='<button class="vcancel vbtn">'.concat(n.ctxt||t.i18n.cancel,"</button>"),a='<button class="vsure vbtn">'.concat(n.otxt||t.i18n.continue,"</button>");if(i.innerHTML="".concat(o).concat(n.type&&a),e.querySelector(".vcancel").addEventListener("click",(function(e){t.alert.hide()})),e.setAttribute("style","display:block;"),n.type){var c=e.querySelector(".vsure");r.default.on("click",c,(function(e){t.alert.hide(),n.cb&&n.cb()}))}},hide:function(){e.setAttribute("style","display:none;")}}}},function(t,e,n){"use strict";t.exports=function(t){var e=new t.v.Query("Comment");e.equalTo("url",t.Comment.url);var n=new t.v.Query("Comment");n.equalTo("url","".concat(t.Comment.url,"/"));var i=AV.Query.or(e,n);i.notEqualTo("isSpam",!0),i.count().then((function(e){t.el.querySelector(".count").innerHTML=e})).catch((function(e){console.log(e),t.el.querySelector(".count").innerHTML=0}))}},function(t,e,n){"use strict";var i=r(n(0)),o=r(n(5));function r(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){var e=t.el.querySelector(".vsmile-icons");i.default.on("click",e,(function(e){var n=t.el.querySelector(".veditor"),i=e.target.src;if(void 0!==i){var r="!(:".concat(decodeURI(i).replace(/^.*\/(.*)$/,"$1"),":)");(0,o.default)(n,r),t.Comment.comment=n.value;var a=t.el.querySelector(".vsubmit");a.getAttribute("disabled")&&a.removeAttribute("disabled")}}))}},function(t,e,n){"use strict";var i,o=n(0),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t){var e=t.el.querySelector(".commentTrigger");r.default.on("click",e,(function(n){e.setAttribute("style","display:none"),t.el.querySelector(".auth-section").removeAttribute("style"),t.el.querySelector(".veditor").focus()}))}},function(t,e,n){"use strict";var i,o=n(6),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t){var e=t.el.querySelector(".vsmile-icons"),n=t.el.querySelector(".vpreview-text");t.reset=function(){for(var i in t.mapping)if(t.mapping.hasOwnProperty(i)){var o=t.mapping[i];t.el.querySelector(".".concat(i)).value="",t.Comment[o]=""}t.Comment.rid="",t.Comment.nick="",(0,r.default)(t),e.getAttribute("triggered")&&(e.setAttribute("style","display:none;"),e.removeAttribute("triggered")),n.getAttribute("triggered")&&(n.setAttribute("style","display:none;"),n.removeAttribute("triggered")),t.el.querySelector(".vcancel-comment-reply").setAttribute("style","display:none"),t.el.querySelector("#vinputs-placeholder").appendChild(t.el.querySelector(".vinputs-wrap"))}}},function(t,e,n){"use strict";var i,o=n(0),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t){r.default.on("click",t.el.querySelector(".vcancel-comment-reply"),(function(e){t.reset()}))}},function(t,e,n){"use strict";var i,o=n(0),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t){var e=t.el.querySelector(".vemoji-btn"),n=t.el.querySelector(".vpreview-text"),i=t.el.querySelector(".vsmile-icons");r.default.on("click",e,(function(t){n.getAttribute("triggered")&&(n.setAttribute("style","display:none;"),n.removeAttribute("triggered")),i.getAttribute("triggered")?(i.setAttribute("style","display:none;"),i.removeAttribute("triggered")):(i.removeAttribute("style"),i.setAttribute("triggered",1))}))}},function(t,e,n){"use strict";var i=a(n(0)),o=a(n(7)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){var e=t.el.querySelector(".vpreview-btn"),n=t.el.querySelector(".vpreview-text"),a=t.el.querySelector(".vsmile-icons");i.default.on("click",e,(function(e){if(a.getAttribute("triggered")&&(a.setAttribute("style","display:none;"),a.removeAttribute("triggered")),n.getAttribute("triggered"))n.setAttribute("style","display:none;"),n.removeAttribute("triggered");else{if(""===t.Comment.comment)return void t.inputs.comment.focus();(0,o.default)(t,n,(function(e){e.innerHTML=e.TEXT,e.removeAttribute("style"),e.setAttribute("triggered",1),(0,r.default)(t)}))}}))}},function(t,e,n){"use strict";var i,o=n(2),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t,e,i){t.md||void 0===t.config.md?Promise.all([n.e(7),n.e(3)]).then(n.t.bind(null,46,7)).then((function(t){var n=t.markdown;e.TEXT=n(e.TEXT),(0,r.default)(e,i)})):(0,r.default)(e,i)}},function(t,e,n){"use strict";var i,o=n(0),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t){for(var e in t.inputs={},t.mapping={veditor:"comment",vnick:"nick",vlink:"link",vmail:"mail"},t.mapping)t.mapping.hasOwnProperty(e)&&function(){var n=t.mapping[e],i=t.el.querySelector(".".concat(e));t.inputs[n]=i,r.default.on("input",i,(function(e){t.Comment[n]=i.value}))}()}},function(t,e,n){"use strict";var i,o=n(0),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t){t.AtEvt=function(e){var n=e.getAttribute("id"),i=e.querySelector("#at-".concat(n));r.default.on("click",i,(function(o){var r=i.getAttribute("at"),a=i.getAttribute("rid");t.Comment.rid=a,t.Comment.at=r,t.inputs.comment.value="".concat(r," , ").concat(t.inputs.comment.value),e.querySelector("#comment-".concat(n)).appendChild(t.el.querySelector(".vinputs-wrap")),t.el.querySelector(".vcancel-comment-reply").removeAttribute("style"),t.el.querySelector(".commentTrigger").setAttribute("style","display:none"),t.el.querySelector(".auth-section").removeAttribute("style"),t.el.querySelector(".veditor").focus(),t.inputs.comment.focus()}))}}},function(t,e,n){"use strict";var i=c(n(0)),o=c(n(7)),r=c(n(3)),a=c(n(40));function c(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){var e=t.el.querySelector(".vsubmit"),n=function(){e.setAttribute("disabled",!0),t.submitting.show();var n,i=new(t.v.Object.extend("Comment"));for(var o in t.Comment)if(t.Comment.hasOwnProperty(o)){if("at"===o)continue;var a=t.Comment[o];i.set(o,a)}i.set("emailHash",md5(t.Comment.mail.toLowerCase().trim())),i.setACL(((n=new t.v.ACL).setPublicReadAccess(!0),n.setPublicWriteAccess(!1),n)),i.save().then((function(n){localStorage&&localStorage.setItem("MiniValineCache",JSON.stringify({nick:t.Comment.nick,link:t.Comment.link,mail:t.Comment.mail}));var i=t.el.querySelector(".count");if(i.innerText=Number(i.innerText)+1,""===t.Comment.rid)t.insertComment(n,null,!0);else{var o=t.el.querySelector("#children-list-".concat(t.Comment.rid));t.insertComment(n,o,!0)}e.removeAttribute("disabled"),t.submitting.hide(),t.nodata.hide(),t.reset(),(0,r.default)(t)})).catch((function(e){t.submitting.hide()}))};i.default.on("click",e,(function(i){if(e.getAttribute("disabled"))t.alert.show({type:0,text:t.i18n.wait+'ã¾(à¹â¹â¡â¹)ï¾"',ctxt:t.i18n.ok});else if(""!==t.Comment.comment)if(""!==t.Comment.nick){(0,o.default)(t,t,(function(t){if(t.Comment.comment=t.TEXT,t.Comment.comment.indexOf(t.Comment.at)>-1&&""!==t.Comment.at){var e='<a class="at" href=\'#'.concat(t.Comment.rid,"'>").concat(t.Comment.at,"</a>");t.Comment.comment=t.Comment.comment.replace(t.Comment.at,e)}var i=a.default.mail(t.Comment.mail),o=a.default.link(t.Comment.link);t.Comment.mail=i.k?i.v:"",t.Comment.link=o.k?o.v:"",i.k&&o.k?n():t.alert.show({type:0,text:t.i18n.inputTips,ctxt:t.i18n.confirm})}))}else t.inputs.nick.focus();else t.inputs.comment.focus()}))}},function(t,e,n){"use strict";t.exports={mail:function(t){return{k:/\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14}/.test(t),v:t}},link:function(t){return t.length>0&&(t=/^(http|https)/.test(t)?t:"http://".concat(t)),{k:!(t.length>0)||/(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/.test(t),v:t}}}},function(t,e,n){"use strict";var i,o=n(0),r=(i=o)&&i.__esModule?i:{default:i};t.exports=function(t,e){t.insertComment=function(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=document.createElement("li");a.setAttribute("class","vcard"),a.setAttribute("id",i.id),a.innerHTML=e.vcard(t,i);for(var c=o||t.el.querySelector(".vlist"),l=c.querySelectorAll("li"),s=a.querySelectorAll("a"),u=0,d=s.length;u<d;u++){var f=s[u];f&&"at"!==f.getAttribute("class")&&(f.setAttribute("target","_blank"),f.setAttribute("rel","nofollow"))}r?c.insertBefore(a,l[0]):c.appendChild(a);var v=a.querySelector(".vcomment");return n(v),t.AtEvt(a),a};var n=function(t){t.offsetHeight>180&&(t.classList.add("expand"),r.default.on("click",t,(function(e){t.setAttribute("class","vcomment")})))}}},function(t,e,n){"use strict";var i=r(n(0)),o=r(n(2));function r(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){t.nestQuery=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.querySelector(".vcomment-children"),a=r.querySelector(".vlist"),c=e.getAttribute("id");n<=0&&r.setAttribute("style","margin-left: 0 !important"),n>=t.maxNestLevel?t.v.Query.doCloudQuery("select count(*) from Comment where rid='".concat(c,"' and (url='").concat(t.Comment.url,"' or url='","".concat(t.Comment.url,"/"),"') order by -createdAt")).then((function(n){if(n.count>0){var o=r.querySelector(".vshow-children-wrapper");o.setAttribute("style","display: block !important;"),o.innerHTML='<span class="vshow-children" rid="'.concat(c,'">').concat(t.i18n.more,"</span>");var a=o.querySelector(".vshow-children");i.default.on("click",a,(function(n){o.setAttribute("style","display: none !important;"),t.nestQuery(e,-1e3)}))}}),(function(t){console.log(t)})):t.v.Query.doCloudQuery("select nick, comment, link, rid, emailHash, isSpam from Comment where rid='".concat(c,"' and (url='").concat(t.Comment.url,"' or url='","".concat(t.Comment.url,"/"),"') order by -createdAt")).then((function(e){var i=(e=e&&e.results||[]).length;if(i)for(var r=function(i){if(!e[i].get("isSpam")){e[i].TEXT=e[i].get("comment"),(0,o.default)(e[i],(function(o){e[i].set("comment",o.TEXT);var r=t.insertComment(e[i],a,!0);t.nestQuery(r,n+1)}))}},c=0;c<i;c++)r(c)})).catch((function(e){console.log(e),t.loading.hide(t.parentCount)}))}}},function(t,e,n){"use strict";var i=a(n(0)),o=a(n(2)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){var e=1;t.parentCount=0,t.parentQuery=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t.loading.show();var a=t.v.Query.doCloudQuery("select nick, comment, link, rid, emailHash, isSpam from Comment where (rid='' or rid is not exists) and (url='".concat(t.Comment.url,"' or url='","".concat(t.Comment.url,"/"),"') order by -createdAt limit ").concat((n-1)*t.pageSize,",").concat(t.pageSize));a.then((function(a){var c=(a=a&&a.results||[]).length;if(c){for(var l=function(e){if(a[e].get("isSpam"))return"continue";a[e].TEXT=a[e].get("comment"),(0,o.default)(a[e],(function(n){a[e].set("comment",n.TEXT);var i=t.insertComment(a[e],t.el.querySelector(".vlist"),!1);i.setAttribute("style","margin-bottom: .5em"),t.nestQuery(i)}))},s=0;s<c;s++)l(s);var u=t.el.querySelector(".vpage");u.innerHTML=t.pageSize*n<t.parentCount?'<div id="vmore" class="more">'.concat(t.i18n.more,"</div>"):"";var d=u.querySelector("#vmore");d&&i.default.on("click",d,(function(n){u.innerHTML="",t.parentQuery(++e)}))}t.loading.hide(t.parentCount),(0,r.default)(t)})).catch((function(e){console.log(e),t.loading.hide(t.parentCount)}))},t.v.Query.doCloudQuery("select count(*) from Comment where (rid='' or rid is not exists) and (url='".concat(t.Comment.url,"' or url='","".concat(t.Comment.url,"/"),"') order by -createdAt")).then((function(e){t.parentCount=e.count,t.parentQuery(1)})).catch((function(t){console.log(t)}))}}])}));